{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Parameters": {
    "CodePipelineServiceRoleARN": {
      "Type": "String",
      "Description": "Code Pipeline Service Role ARN"
    }
  },
  "Resources": {
    "ArtifactS3Bucket": {
      "Type": "AWS::S3::Bucket",
      "Resources": {
        "BucketName": "SimpleAWSTest50ArtefactBucket"
      }
    },
    
    "AppPipeline": {
      "Type": "AWS::CodePipeline::Pipeline",
      "Properties": {
        "RoleArn": "arn:aws:iam::780487234683:policy/service-role/AWSCodePipelineServiceRole-eu-west-2-dotNetPipeline",
        "Stages": [
          {
            "Name": "Source",
            "Actions": [
              {
                "Name": "SourceAction",
                "InputArtifacts": [],
                "ActionTypeId": {
                  "Category": "Source",
                  "Owner": "AWS",
                  "Version": "1",
                  "Provider": "CodeStarSourceConnection"
                },
                "Configuration": {
                  "ConnectionArn": "arn:aws:codestar-connections:eu-west-2:780487234683:connection/43c0aecd-9e08-4eba-83b6-2b2131d809fb",
                  "FullRepositoryId": "kufena/SimpleAWSTest5.0",
                  "BranchName": "main",
                  "OutputArtifactFormat": "CODE_ZIP"
                },
                "OutputArtifacts": [
                  {
                    "Name": "PrimarySourceOutput"
                  }
                ],
                "RunOrder": 1
              }
            ]
          },
          {
            "Name": "Build",
            "ActionTypeId": {
              "Category": "Build",
              "Owner": "AWS",
              "Version": "1",
              "Provider": "CodeBuild"
            },
            "RunOrder": 2,
            "Configuration": {
              "BatchEnabled": "true",
              "CombineArtifacts": "true",
              "ProjectName": "my-build-project",
              "PrimarySource": "PrimarySourceOutput"
            },
            "OutputArtifacts": [
              {
                "Name": "PrimaryBuildOutput"
              }
            ],
            "InputArtifacts": [
              {
                "Name": "PrimarySourceOutput"
              }
            ]
          },
          {
            "Name": "Deploy",
            "ActionTypeId": {
              "Category": "Deploy",
              "Owner": "AWS",
              "Version": "1",
              "Provider": "CodeDeploy"
            },
            "RunOrder": 3
          }
        ],
        
        "ArtifactStore": {
          "Type": "S3",
          "Location": {
            "Ref": "ArtifactStoreS3Location"
          }
        }
      }
    }
  }